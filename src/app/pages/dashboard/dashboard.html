<div class="dashboard">
  <section class="panel panel--accent">
    <header class="panel__header">
      <div>
        <p class="panel__eyebrow">Quick Search</p>
        <h2 class="panel__title">Find Pokémon by Name</h2>
        <p class="panel__subtitle">Jump straight to the Pokémon you want to explore.</p>
      </div>
    </header>

    <form
      class="search-form"
      (submit)="searchPokemon(); $event.preventDefault()"
      aria-label="Search a Pokémon by name"
    >
      <label class="field">
        <span class="field__label">Pokémon Name</span>
        <input
          type="text"
          name="pokemonName"
          [(ngModel)]="pokemonName"
          placeholder="e.g. Pikachu"
          class="field__input"
        />
      </label>
      <button type="submit" class="button button--primary">Search</button>
    </form>

    <div *ngIf="pokemon" class="pokemon-summary">
      <div class="pokemon-summary__avatar">
        <img [src]="pokemon.sprites.front_default" alt="{{ pokemon.name }}" />
      </div>
      <div class="pokemon-summary__content">
        <h3 class="pokemon-summary__name">{{ pokemon.name | titlecase }}</h3>
        <dl class="pokemon-summary__meta">
          <div>
            <dt>Height</dt>
            <dd>{{ pokemon.height }}</dd>
          </div>
          <div>
            <dt>Weight</dt>
            <dd>{{ pokemon.weight }}</dd>
          </div>
        </dl>
      </div>
    </div>

    <div *ngIf="pokemon === null" class="alert alert--error">
      Pokémon not found! Please try another name.
    </div>
  </section>

  <section class="panel">
    <header class="panel__header panel__header--between">
      <div>
        <h2 class="panel__title">Pokémon Dashboard</h2>
        <p class="panel__subtitle">Browse the Pokédex and dive into quick details.</p>
      </div>
      <label class="field field--compact">
        <span class="field__label sr-only">Filter Pokémon by name</span>
        <input
          [(ngModel)]="search"
          (input)="onSearchChange()"
          name="search"
          placeholder="Search by name..."
          aria-label="Search Pokémon by name"
          class="field__input"
        />
      </label>
    </header>

    <div *ngIf="loading" class="status status--loading">Loading…</div>
    <div *ngIf="error" class="alert alert--error">{{ error }}</div>

    <div *ngIf="!loading && !error">
      <div class="table-wrapper">
        <table class="data-table">
          <thead>
            <tr>
              <th scope="col">#</th>
              <th scope="col">Sprite</th>
              <th scope="col">Name</th>
              <th scope="col" class="align-right">Action</th>
            </tr>
          </thead>
          <tbody>
            <tr *ngFor="let p of filtered">
              <td>{{ p.id }}</td>
              <td>
                <img [src]="p.image" [alt]="p.name" width="48" height="48" loading="lazy" />
              </td>
              <td class="capitalize">{{ p.name }}</td>
              <td class="align-right">
                <button type="button" (click)="view(p)" class="button button--ghost">
                  View
                </button>
              </td>
            </tr>
            <tr *ngIf="filtered.length === 0">
              <td colspan="4" class="empty">No results</td>
            </tr>
          </tbody>
        </table>
      </div>

      <footer class="pagination">
        <button
          type="button"
          (click)="prev()"
          [disabled]="offset === 0"
          class="button button--ghost"
        >
          ◀ Prev
        </button>
        <span class="pagination__status">
          Showing {{ offset + 1 }}–{{ Math.min(offset + limit, total) }} of {{ total }}
        </span>
        <button
          type="button"
          (click)="next()"
          [disabled]="offset + limit >= total"
          class="button button--ghost"
        >
          Next ▶
        </button>
      </footer>
    </div>
  </section>
</div>
